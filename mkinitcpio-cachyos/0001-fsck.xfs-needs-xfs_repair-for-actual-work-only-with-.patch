From 0894d0c7023b7385890cbdf4f9a6db932adb519e Mon Sep 17 00:00:00 2001
From: Geert Hendrickx <geert@hendrickx.be>
Date: Thu, 15 Sep 2022 10:19:41 +0200
Subject: [PATCH] fsck.xfs needs xfs_repair for actual work (only with
 -f/forcefsck).

---
 install/fsck | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/install/fsck b/install/fsck
index 366cdbd..4f5cf93 100644
--- a/install/fsck
+++ b/install/fsck
@@ -10,6 +10,9 @@ build() {
             add_binary fsck.ext4
             add_symlink /usr/bin/fsck.ext2 fsck.ext4
             add_symlink /usr/bin/fsck.ext3 fsck.ext4
+        elif [[ $1 = xfs ]]; then
+            add_binary fsck.xfs
+            add_binary xfs_repair
         else
             add_binary "fsck.$1"
         fi
@@ -23,7 +26,7 @@ build() {
             add_fsck $usrfstype && (( ++added ))
         fi
     else
-        for fsck in /usr/bin/fsck.*; do
+        for fsck in /usr/bin/fsck.* /usr/bin/xfs_repair; do
             [[ -f $fsck ]] || continue
             add_binary "$fsck" && (( ++added ))
         done
-- 
2.37.3.485.gbe1a02a17e

