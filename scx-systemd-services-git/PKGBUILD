# Maintainer: Piotr GÃ³rski <lucjan.lucjanov@gmail.com>

pkgname=scx-systemd-services-git
gitname=sched-ext-systemd
pkgver=20240113.r8.gf904053
pkgrel=3
pkgdesc='SystemD sched-ext services'
arch=('any')
license=('GPL-2.0-only')
url="https://github.com/sirlucjan/$gitname"
source=("git+https://github.com/sirlucjan/sched-ext-systemd")
sha512sums=('SKIP')
depends=('scx-scheds')
makedepends=('git')

pkgver() {
  cd $gitname
  echo "$(git show --format='%cI' -q main | sed 's/T.*//g;s/-//g').r$(git rev-list --count HEAD).g$(git rev-parse --short HEAD)"
}

package() {
  cd $gitname/systemd-services
  local services="$pkgdir/etc/systemd/system/"

  for scx in *; do
    install -Dm644 $scx "$services/$scx"
  done
}
